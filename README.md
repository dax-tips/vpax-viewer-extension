# VertiPaq Analyzer Viewer for VS Code

A powerful Visual Studio Code extension for viewing and analyzing `.vpax` files from VertiPaq Analyzer. Get instant insights into your Power BI and Analysis Services Tabular models.

[![Version](https://img.shields.io/badge/version-0.1.0-blue.svg)](https://github.com/dax-tips/vpax-viewer-extension)
[![VS Code](https://img.shields.io/badge/VS%20Code-1.85.0+-blue.svg)](https://code.visualstudio.com/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

## Features

### üìä Interactive Tables View
- **Expandable tables** - Click to see all columns with detailed statistics
- **Sortable columns** - Sort by any column (name, rows, size, columns, relationships)
- **Size in MB** - See exact memory usage per table
- **Search & filter** - Quickly find tables

### üìà Comprehensive Column Statistics
- **Cardinality** - Distinct value counts
- **Size breakdown** - Total Size, Data Size, Dictionary Size (in bytes)
- **Data types** - See column types at a glance
- **Encoding** - Compression types (HASH, VALUE, etc.)
- **Hidden columns** - Visually distinguished

### üîó Relationships Grid
- **Sortable relationships** - Sort by any table or column
- **Many:Many highlighting** - Potential issues highlighted in warning color
- **Cardinality indicators** - See relationship types clearly
- **Bi-directional markers** - ‚Üî for bi-directional, ‚Üí for single direction

### üì¶ Partition Information
- **Row counts** - Accurate partition row counts
- **Segments** - Total segments per partition
- **Records/Segment** - Distribution analysis
- **Mode** - DirectLake, Import, etc.
- **Temperature & Last Accessed** - When available

### üìã Model Summary
- **Total size in memory** - Model size in MiB
- **Last data refresh** - When data was last updated
- **Analysis date** - VPAX extraction timestamp
- **Compatibility level** - Model compatibility
- **Server information** - Connection details

## Installation

### Option 1: Install from VSIX (Local Installation)

1. **Build the extension:**
   ```bash
   npm install
   npm run compile
   npm run package
   ```

2. **Install in VS Code:**
   - Open VS Code
   - Press `Ctrl+Shift+P` (Windows/Linux) or `Cmd+Shift+P` (Mac)
   - Type "Extensions: Install from VSIX"
   - Select the `vpax-viewer-0.1.0.vsix` file

3. **Verify installation:**
   - Open any `.vpax` file
   - The VertiPaq Analyzer viewer should open automatically

### Option 2: Install from Marketplace (Coming Soon)

Once published to the VS Code Marketplace:
1. Open VS Code
2. Go to Extensions (Ctrl+Shift+X)
3. Search for "VertiPaq Analyzer Viewer"
4. Click Install

## Usage

1. **Open a .vpax file** - Just double-click any `.vpax` file in VS Code
2. **Navigate tabs** - Click on Tables, Columns, Relationships, or Partitions
3. **Sort data** - Click any column header to sort
4. **Expand tables** - Click ‚ñ∂ next to table names to see all columns
5. **Search** - Use the search boxes to filter data
6. **Analyze** - Review the model summary at the top

## What is a .vpax file?

`.vpax` files are VertiPaq Analyzer Exchange files that contain detailed statistics about Power BI/Analysis Services Tabular models, including:
- Table and column statistics
- Memory usage and cardinality
- Relationship information  
- Partition details
- Data model metadata

These files are generated by tools like [DAX Studio](https://daxstudio.org/) using the "Export VertiPaq Metrics" feature.

## Screenshots

### Tables View with Expandable Columns
![Tables View](images/tables-view.png)

### Relationships with Many:Many Highlighting
![Relationships](images/relationships-view.png)

### Comprehensive Model Summary
![Summary](images/summary-view.png)

## Development

### Prerequisites

- Node.js 20.x or higher
- npm 8.x or higher
- VS Code 1.85.0 or higher
- TypeScript 5.3.0 or higher

### Build from Source

```bash
# Clone the repository
git clone https://github.com/dax-tips/vpax-viewer-extension.git
cd vpax-viewer-extension

# Install dependencies
npm install

# Compile TypeScript
npm run compile

# Watch for changes during development
npm run watch

# Package extension
npm run package
```

### Project Structure

```
vpax-viewer-extension/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ extension.ts          # Extension activation
‚îÇ   ‚îú‚îÄ‚îÄ vpaxEditorProvider.ts # Custom editor implementation
‚îÇ   ‚îî‚îÄ‚îÄ vpaxParser.ts          # VPAX file parser
‚îú‚îÄ‚îÄ out/                       # Compiled JavaScript
‚îú‚îÄ‚îÄ package.json              # Extension manifest
‚îî‚îÄ‚îÄ README.md                 # This file
```

## Publishing to GitHub

See [PUBLISHING.md](PUBLISHING.md) for detailed instructions on:
- Creating a GitHub repository
- Setting up CI/CD
- Publishing to VS Code Marketplace
- Version management

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## Changelog

### Version 0.1.0 (Initial Release)

#### Features
- ‚úÖ Interactive tables view with expand/collapse
- ‚úÖ Sortable grids (Tables, Columns, Relationships, Partitions)
- ‚úÖ Comprehensive column statistics
- ‚úÖ Many:Many relationship highlighting
- ‚úÖ Model summary with metadata
- ‚úÖ Partition details with segments
- ‚úÖ Search and filter capabilities
- ‚úÖ VS Code theme integration

## License

MIT License - see [LICENSE](LICENSE) file for details

## Credits

Created by the DAX Tips community for Power BI and Analysis Services developers.

- Website: [https://dax.tips](https://dax.tips)
- GitHub: [https://github.com/dax-tips](https://github.com/dax-tips)

## Support

- üêõ **Report bugs:** [GitHub Issues](https://github.com/dax-tips/vpax-viewer-extension/issues)
- üí° **Feature requests:** [GitHub Discussions](https://github.com/dax-tips/vpax-viewer-extension/discussions)
- üìß **Contact:** Open an issue on GitHub

---

**Enjoy analyzing your Power BI models!** üìä
npm run package
```

### Testing

1. Press `F5` in VS Code to launch Extension Development Host
2. Open a `.vpax` file to test the viewer
3. Make changes and reload the window to see updates

## Roadmap

- [ ] Export statistics to CSV/Excel
- [ ] Compare two VPAX files side-by-side
- [ ] Interactive relationship diagram
- [ ] Best practice recommendations
- [ ] DAX measures viewer
- [ ] Performance optimization suggestions

## Credits

Built for the Power BI and DAX community by dax.tips

## License

MIT
